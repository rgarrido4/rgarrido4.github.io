
<!DOCTYPE html>
<html lang="ca">
<head>
  <!-- ======================================================================
       CAP√áALERA DEL DOCUMENT: Aqu√≠ definim les metadades, les llibreries i els estils que 
       s'aplicaran a tota la p√†gina.
       ====================================================================== -->

  <!-- Declarem que el document utilitza la codificaci√≥ UTF-8 per suportar car√†cters especials. -->
  <meta charset="UTF-8">
  
  <!-- Aquest meta etiqueta assegura que la p√†gina s'adapta a la mida de qualsevol dispositiu i 
       evita que l'usuari pugui ampliar o reduir la vista manualment (user-scalable=no). -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  
  <!-- Defineix el t√≠tol que es mostrar√† a la pestanya del navegador. -->
  <title>Art Facial Responsiu</title>
  
  <!-- Importem la llibreria p5.js des d'una CDN. Aquesta llibreria ens facilita la creaci√≥ d'animacions i gr√†fics -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.11.3/p5.js"></script>
  
  <!-- Importem la llibreria ml5.js que utilitza models d'aprenentatge autom√†tic, incloent la detecci√≥ facial -->
  <script src="https://cdn.jsdelivr.net/gh/ml5js/Intro-ML-Arts-IMA@ml5-build-10-7-19/ml5_build/ml5.min.js"></script>
  
  <!-- ======================================================================
       ESTILS CSS: Aqu√≠ definim com es veur√† la p√†gina: colors, mides, fonts, etc.
       ====================================================================== -->
  <style>
    /* Estil per al cos de la p√†gina */
    body {
      margin: 0;              /* Elimina el marge per defecte del navegador. */
      padding: 0;             /* Elimina el farcit per defecte del navegador. */
      overflow: hidden;       /* No permet el despla√ßament per scroll si el contingut √©s m√©s gran. */
      touch-action: none;     /* Deshabilita accions t√≠piques del tacte per gestionar-les manualment. */
      background: #f0f0f0;     /* Defineix un color de fons clar per a tota la p√†gina. */
    }

    /* Estil per a la pantalla de c√†rrega que es mostra mentre es carreguen els models */
    #loading-screen {
      position: fixed;              /* Aquesta pantalla roman fixa sobre tot el contingut. */
      top: 0;                       /* La seva posici√≥ comen√ßa a la part superior. */
      left: 0;                      /* La seva posici√≥ comen√ßa a l'esquerra. */
      width: 100%;                  /* Ocupa el 100% de l'amplada de la finestra. */
      height: 100%;                 /* Ocupa el 100% de l'al√ßada de la finestra. */
      background: rgba(255,255,255,0.95); /* Fons blanc lleugerament transparent. */
      display: flex;                /* Utilitza flexbox per centrar el contingut. */
      flex-direction: column;       /* Organitza els elements en columna. */
      justify-content: center;      /* Centra verticalment el contingut. */
      align-items: center;          /* Centra horitzontalment el contingut. */
      font-family: Arial, sans-serif; /* Defineix la font per al text. */
      z-index: 1000;               /* Assegura que aquesta capa est√† per sobre de tots els altres elements. */
    }

    /* Estils per a l'indicador d'espera (loader) */
    .loader {
      width: 40px;                         /* Amplada del loader. */
      height: 40px;                        /* Al√ßada del loader. */
      border: 5px solid #3498db;           /* Defineix una vora amb color blau. */
      border-top-color: transparent;       /* Fa la part superior transparent per a l'efecte de girar. */
      border-radius: 50%;                  /* Fa que el loader tingui forma circular. */
      animation: spin 1s linear infinite;  /* Aplica una animaci√≥ de gir cont√≠nua. */
    }

    /* Defineix l'animaci√≥ 'spin' que gira el loader */
    @keyframes spin {
      to { transform: rotate(360deg); }    /* Al final de l'animaci√≥, gira 360 graus. */
    }

    /* Estils per al text dins de la pantalla de c√†rrega */
    #loading-screen p {
      margin-top: 15px;       /* Afageix un espai (marge) per sobre del text. */
      font-size: 1.1em;       /* Incrementa lleugerament la mida de la lletra. */
      color: #333;            /* Defineix un color gris fosc per al text. */
    }
  </style>
</head>
<body>
  <!-- ======================================================================
       COS DEL DOCUMENT: Aqu√≠ col¬∑locarem els elements que es mostraran a la p√†gina.
       ====================================================================== -->

  <!-- Div que cont√© la pantalla de c√†rrega mostrada mentre es carreguen els models -->
  <div id="loading-screen">
    <div class="loader"></div> <!-- Element que mostra l'animaci√≥ girat√≤ria. -->
    <p>Carregant models...</p>  <!-- Missatge que informa a l'usuari que s'estan carregant els models. -->
  </div>

  <!-- ======================================================================
       SCRIPT JavaScript: Aqu√≠ definim el comportament i la interacci√≥ de la p√†gina.
       ====================================================================== -->
  <script>
    // Declarem variables globals que utilitzarem en tot el nostre codi.
    let faceapi,         // Aquesta variable guardar√† el model de detecci√≥ facial.
        detections = [], // Aqu√≠ s'emmagatzemaran els resultats de les deteccions facials.
        video;           // Aquesta variable contindr√† la captura de v√≠deo de la c√†mera.

    let modelsReady = false; // Indica si els models d'aprenentatge autom√†tic s'han carregat completament.
    const VIRTUAL_W = 800, VIRTUAL_H = 600;  // Definim dimensions virtuals per al disseny responsive.
    
    // Objecte que emmagatzema l'expressi√≥ facial actual: emoci√≥ dominant i la seva intensitat.
    let currentExpression = { dominant: 'neutral', intensity: 0 };

    // La funci√≥ setup() s'executa una sola vegada quan la p√†gina es carrega.
    function setup() {
      // Creem un canvas que ocupar√† tota la finestra del navegador.
      const canvas = createCanvas(windowWidth, windowHeight);
      // Configurem el canvas perqu√® no tingui comportaments per defecte en dispositius t√†ctils.
      canvas.elt.style.touchAction = 'none';
      
      // Iniciem la captura del v√≠deo des de la c√†mera.
      video = createCapture(VIDEO);
      video.size(320, 240); // Defineix la mida inicial del flux de v√≠deo.
      video.hide();         // Amaguem la visualitzaci√≥ per defecte del v√≠deo (el dibuixarem manualment).
      video.elt.muted = true;      // Silencia l'√†udio del v√≠deo.
      video.elt.playsinline = true; // Permet que el v√≠deo es reprodueixi dins de la p√†gina, sense pantalla completa.

      // Defineix les opcions per a la detecci√≥ facial:
      const options = {
        withLandmarks: true,     // Detecta punts clau de la cara com els ulls, nas i boca.
        withExpressions: true,   // Detecta les expressions facials (emocions).
        withDescriptors: false   // No calen descriptors facials en aquest cas.
      };
      
      // Inicialitza el model de detecci√≥ facial (faceapi) amb el v√≠deo i les opcions definides.
      // Quan el model estigui carregat, s'executar√† la funci√≥ callback.
      faceapi = ml5.faceApi(video, options, () => {
        modelsReady = true; // Marquem que els models ja estan llestos.
        // Amaguem la pantalla de c√†rrega perqu√® el proc√©s de c√†rrega ha finalitzat.
        document.getElementById('loading-screen').style.display = 'none';
        // Inicialitza la detecci√≥ facial passant-li la funci√≥ 'gotResults' com a callback.
        faceapi.detect(gotResults);
      });
    }

    // La funci√≥ windowResized() s'executa cada cop que la mida de la finestra canvia.
    function windowResized() {
      // Redimensiona el canvas per adaptar-lo a la nova mida de la finestra.
      resizeCanvas(windowWidth, windowHeight);
      // Ajusta la mida del v√≠deo per mantenir una resoluci√≥ adequada
      video.size(max(width/4, 160), max(height/4, 120));
    }

    // Funci√≥ callback que rep els resultats de la detecci√≥ facial.
    // 'err' cont√© possibles errors i 'results' cont√© les deteccions facials.
    function gotResults(err, results) {
      if (err) {
        // Si s'ha produ√Øt un error, el mostrem a la consola i al missatge de la pantalla de c√†rrega.
        console.error(err);
        document.getElementById('loading-screen').innerHTML = 
          '<p style="color: red">Error! Comprova la c√†mera i actualitza.</p>';
        return; // Aturem l'execuci√≥ si hi ha error.
      }
      // Assignem els resultats detectats a la variable global 'detections'.
      detections = results;
      // Si s'ha detectat almenys una cara, actualitzem l'expressi√≥ facial actual.
      if (detections.length > 0) updateCurrentExpression();
      // Continuem executant la detecci√≥ facial de manera cont√≠nua.
      faceapi.detect(gotResults);
    }

    // Funci√≥ que actualitza l'objecte 'currentExpression' segons la detecci√≥ facial.
    function updateCurrentExpression() {
      let maxIntensity = 0;  // Variable per emmagatzemar la intensitat m√†xima trobada.
      // Iterem per cada detecci√≥ (cada cara detectada).
      detections.forEach(face => {
        const expr = face.expressions; // Obtenim les expressions detectades en aquesta cara.
        // Determinem quina √©s l'expressi√≥ dominant (la que t√© m√©s intensitat).
        const dominant = Object.keys(expr).reduce((a, b) => expr[a] > expr[b] ? a : b);
        // Si la intensitat de l'expressi√≥ dominant √©s superior a la m√†xima trobada fins ara...
        if (expr[dominant] > maxIntensity) {
          // Actualitzem l'objecte currentExpression amb aquesta nova expressi√≥
          currentExpression = {
            dominant: dominant,
            intensity: expr[dominant]
          };
          // Actualitzem la intensitat m√†xima.
          maxIntensity = expr[dominant];
        }
      });
    }

    // La funci√≥ draw() s'executa cont√≠nuament (al voltant de 60 vegades per segon) per redibuixar el canvas.
    function draw() {
      background(245); // Pinta el fons del canvas amb un color molt clar (quasi blanc).

      // CALCUL SERVEIX PER ESCALAR LA DISSENY DE L'ART FACIAL:
      // Calcula el factor d'escala per adaptar el disseny virtual a la mida real del canvas.
      const scaleFactor = min(width / VIRTUAL_W, height / VIRTUAL_H);
      // Calcula el despla√ßament horitzontal per centrar el disseny.
      const offsetX = (width - VIRTUAL_W * scaleFactor) / 2;
      // Calcula el despla√ßament vertical per centrar el disseny.
      const offsetY = (height - VIRTUAL_H * scaleFactor) / 2;
      
      push();                // Desa l'estat actual del canvas.
      translate(offsetX+200, offsetY+100); // Trasllada l'origen del canvas als offsets calculats.
      scale(scaleFactor*1.5);           // Aplica l'escala per adaptar el disseny.
      drawArt();                    // Crida a la funci√≥ que dibuixa l'art basant-se en l'expressi√≥.
      pop();                 // Restaura l'estat anterior del canvas.
      
      drawHUD();             // Dibuixa el Heads-Up Display (informaci√≥ d'estat) sobre el canvas.
      drawVideoPreview();    // Dibuixa una petita previsualitzaci√≥ del flux de v√≠deo.
    }

    // Funci√≥ per dibuixar l'art generat segons l'expressi√≥ facial detectada.
    function drawArt() {
      // Utilitza desestructuraci√≥ per obtenir les propietats 'dominant' i 'intensity' de l'objecte currentExpression.
      const { dominant, intensity } = currentExpression;
      const t = frameCount * 0.05;  // Variable temporal per animacions basades en el nombre de frames.
      // Calcula les coordenades centrals per a la zona de dibuix virtual.
      const centerX = VIRTUAL_W / 2;
      const centerY = VIRTUAL_H / 2;
      // Calcula una mida base que dep√®n de la intensitat de l'expressi√≥.
      const baseSize = min(VIRTUAL_W, VIRTUAL_H) * 0.3 * intensity;

      // Configura l'amplada del tra√ß basant-se en la intensitat (m√©s intens ‚Üí tra√ß m√©s gruixut).
      strokeWeight(map(intensity, 0, 1, 1, 4));
      noFill(); // Per defecte, no omple les figures dibuixades.

      // Selecciona el dibuix a realitzar segons l'expressi√≥ facial dominant.
      switch (dominant) {
        case 'happy':
          stroke(0,0,0); // contorn negre
           fill(255,200,0); // groc interior
          //fill(intensity*255,intensity*120,118);
            fill(255,200,0); // groc interior
          beginShape();//cara
curveVertex(143, 254.1875);
curveVertex(155, 254.1875);
curveVertex(165, 251.1875);
curveVertex(175, 250.1875);
curveVertex(187, 247.1875);
curveVertex(204, 238.1875);
curveVertex(216, 230.1875);
curveVertex(224, 221.1875);
curveVertex(232, 214.1875);
curveVertex(240, 203.1875);
curveVertex(248, 189.1875);
curveVertex(253, 176.1875);
curveVertex(259, 157.1875);
curveVertex(260, 147.1875);
curveVertex(257, 135.1875);
curveVertex(252, 117.1875);
curveVertex(246, 105.1875);
curveVertex(240, 94.1875);
curveVertex(231, 83.1875);
curveVertex(223, 71.1875);
curveVertex(213, 60.1875);
curveVertex(205, 53.1875);
curveVertex(190, 52.1875);
curveVertex(154, 52.1875);
curveVertex(99, 53.1875);
curveVertex(87, 57.1875);
curveVertex(77, 66.1875);
curveVertex(58, 81.1875);
curveVertex(40, 99.1875);
curveVertex(33, 111.1875);
curveVertex(27, 127.1875);
curveVertex(27, 143.1875);
curveVertex(27, 165.1875);
curveVertex(30, 182.1875);
curveVertex(38, 201.1875);
curveVertex(49, 218.1875);
curveVertex(66, 233.1875);
curveVertex(80, 240.1875);
curveVertex(89, 244.1875);
curveVertex(96, 247.1875);
curveVertex(107, 250.1875);
curveVertex(117, 251.1875);
curveVertex(129, 253.1875);
curveVertex(142, 254.1875);
endShape(CLOSE);
          stroke(0,0,0);
       beginShape();//oreja derecha
vertex(225, 71.1875);
vertex(232, 64.1875);
vertex(240, 60.1875);
vertex(248, 56.1875);
vertex(255, 52.1875);
vertex(262, 50.1875);
vertex(266, 51.1875);
vertex(268, 56.1875);
vertex(269, 61.1875);
vertex(270, 65.1875);
vertex(270, 70.1875);
vertex(270, 75.1875);
vertex(270, 80.1875);
vertex(269, 86.1875);
vertex(267, 91.1875);
vertex(265, 98.1875);
vertex(263, 105.1875);
vertex(256, 131.1875);
vertex(253, 123.1875);
vertex(251, 113.1875);
vertex(248, 106.1875);
vertex(243, 98.1875);
vertex(236, 87.1875);
vertex(230, 79.1875);
vertex(224, 71.1875);
endShape(CLOSE);
          beginShape();//oreja izquierda
vertex(73, 67.1875);
vertex(61, 77.1875);
vertex(49, 89.1875);
vertex(39, 101.1875);
vertex(32, 112.1875);
vertex(26, 128.1875);
vertex(27, 105.1875);
vertex(27, 95.1875);
vertex(27, 85.1875);
vertex(29, 75.1875);
vertex(32, 65.1875);
vertex(36, 49.1875);
vertex(47, 52.1875);
vertex(57, 57.1875);
vertex(64, 60.1875);
vertex(71, 66.1875);
endShape(CLOSE);
          stroke(0,0,0); // contorn negre
            beginShape();//ojo derecho
vertex(167, 117.1875);
vertex(176, 112.1875);
vertex(186, 110.1875);
vertex(196, 114.1875);
vertex(200, 119.1875);
vertex(192, 123.1875);
vertex(181, 125.1875);
vertex(172, 123.1875);
vertex(167, 118.1875);
endShape(CLOSE);
          beginShape();//ojo izquierdo
vertex(79, 116.1875);
vertex(84, 122.1875);
vertex(92, 126.1875);
vertex(102, 127.1875);
vertex(111, 123.1875);
vertex(117, 116.1875);
vertex(107, 111.1875);
vertex(95, 110.1875);
vertex(84, 112.1875);
vertex(79, 115.1875);
endShape(CLOSE);
          beginShape();//nariz
vertex(144, 158.1875);
vertex(152, 155.1875);
vertex(158, 151.1875);
vertex(159, 147.1875);
vertex(155, 143.1875);
vertex(147, 143.1875);
vertex(138, 143.1875);
vertex(131, 146.1875);
vertex(131, 152.1875);
vertex(137, 155.1875);
endShape(CLOSE);
          beginShape();//mofletes
vertex(102, 155.1875);
vertex(99, 160.1875);
vertex(98, 168.1875);
vertex(100, 179.1875);
vertex(104, 188.1875);
vertex(112, 195.1875);
vertex(122, 197.1875);
vertex(133, 194.1875);
vertex(141, 186.1875);
vertex(144, 175.1875);
vertex(143, 166.1875);
vertex(143, 159.1875);
vertex(142, 186.1875);
vertex(148, 193.1875);
vertex(156, 196.1875);
vertex(168, 197.1875);
vertex(178, 190.1875);
vertex(184, 180.1875);
vertex(185, 169.1875);
vertex(183, 158.1875);
endShape(CLOSE);
          beginShape();//llengua
vertex(124, 198.1875);
vertex(124, 208.1875);
vertex(125, 218.1875);
vertex(130, 230.1875);
vertex(140, 236.1875);
vertex(149, 235.1875);
vertex(154, 229.1875);
vertex(158, 221.1875);
vertex(160, 208.1875);
vertex(161, 199.1875);
vertex(154, 196.1875);
vertex(147, 194.1875);
vertex(142, 190.1875);
vertex(136, 193.1875);
vertex(128, 197.1875);
vertex(142, 189.1875);
vertex(139, 197.1875);
vertex(139, 203.1875);
vertex(139, 210.1875);
vertex(139, 218.1875);
vertex(141, 224.1875);
endShape();
        
         noFill();
          break;
          

        case 'sad':
          fill(50,100,200,150); // blau
          stroke(0,0,0);//negre contorn
           beginShape();//cara
curveVertex(143, 254.1875);
curveVertex(155, 254.1875);
curveVertex(165, 251.1875);
curveVertex(175, 250.1875);
curveVertex(187, 247.1875);
curveVertex(204, 238.1875);
curveVertex(216, 230.1875);
curveVertex(224, 221.1875);
curveVertex(232, 214.1875);
curveVertex(240, 203.1875);
curveVertex(248, 189.1875);
curveVertex(253, 176.1875);
curveVertex(259, 157.1875);
curveVertex(260, 147.1875);
curveVertex(257, 135.1875);
curveVertex(252, 117.1875);
curveVertex(246, 105.1875);
curveVertex(240, 94.1875);
curveVertex(231, 83.1875);
curveVertex(223, 71.1875);
curveVertex(213, 60.1875);
curveVertex(205, 53.1875);
curveVertex(190, 52.1875);
curveVertex(154, 52.1875);
curveVertex(99, 53.1875);
curveVertex(87, 57.1875);
curveVertex(77, 66.1875);
curveVertex(58, 81.1875);
curveVertex(40, 99.1875);
curveVertex(33, 111.1875);
curveVertex(27, 127.1875);
curveVertex(27, 143.1875);
curveVertex(27, 165.1875);
curveVertex(30, 182.1875);
curveVertex(38, 201.1875);
curveVertex(49, 218.1875);
curveVertex(66, 233.1875);
curveVertex(80, 240.1875);
curveVertex(89, 244.1875);
curveVertex(96, 247.1875);
curveVertex(107, 250.1875);
curveVertex(117, 251.1875);
curveVertex(129, 253.1875);
curveVertex(142, 254.1875);
endShape(CLOSE);
            beginShape();//ojo derecho
vertex(167, 117.1875);
vertex(176, 112.1875);
vertex(186, 110.1875);
vertex(196, 114.1875);
vertex(200, 119.1875);
vertex(192, 123.1875);
vertex(181, 125.1875);
vertex(172, 123.1875);
vertex(167, 118.1875);
endShape(CLOSE);
          beginShape();//ojo izquierdo
vertex(79, 116.1875);
vertex(84, 122.1875);
vertex(92, 126.1875);
vertex(102, 127.1875);
vertex(111, 123.1875);
vertex(117, 116.1875);
vertex(107, 111.1875);
vertex(95, 110.1875);
vertex(84, 112.1875);
vertex(79, 115.1875);
endShape(CLOSE);
          beginShape();//oreja derecha
curveVertex(223, 69.1875);
curveVertex(230, 65.1875);
curveVertex(235, 61.1875);
curveVertex(241, 58.1875);
curveVertex(249, 53.1875);
curveVertex(258, 50.1875);
curveVertex(266, 46.1875);
curveVertex(272, 47.1875);
curveVertex(276, 51.1875);
curveVertex(280, 54.1875);
curveVertex(282, 61.1875);
curveVertex(282, 67.1875);
curveVertex(281, 73.1875);
curveVertex(279, 86.1875);
curveVertex(276, 94.1875);
curveVertex(267, 86.1875);
curveVertex(258, 75.1875);
curveVertex(267, 85.1875);
curveVertex(262, 95.1875);
curveVertex(258, 101.1875);
curveVertex(248, 109.1875);
curveVertex(242, 98.1875);
curveVertex(237, 88.1875);
curveVertex(230, 78.1875);
curveVertex(223, 71.1875);
endShape(CLOSE);
          beginShape();//orella esquerra
curveVertex(73, 67.1875);
curveVertex(64, 61.1875);
curveVertex(54, 56.1875);
curveVertex(42, 51.1875);
curveVertex(34, 48.1875);
curveVertex(28, 52.1875);
curveVertex(21, 57.1875);
curveVertex(13, 64.1875);
curveVertex(9, 71.1875);
curveVertex(9, 79.1875);
curveVertex(10, 85.1875);
curveVertex(15, 92.1875);
curveVertex(21, 87.1875);
curveVertex(29, 79.1875);
curveVertex(24, 86.1875);
curveVertex(24, 94.1875);
curveVertex(24, 101.1875);
curveVertex(27, 114.1875);
curveVertex(27, 117.1875);
curveVertex(33, 110.1875);
curveVertex(44, 96.1875);
curveVertex(57, 81.1875);
curveVertex(71, 67.1875);
endShape(CLOSE);
          beginShape();//lagrima derecha
curveVertex(181, 127.1875);
curveVertex(176, 135.1875);
curveVertex(174, 142.1875);
curveVertex(174, 149.1875);
curveVertex(174, 156.1875);
curveVertex(178, 161.1875);
curveVertex(184, 162.1875);
curveVertex(191, 160.1875);
curveVertex(193, 153.1875);
curveVertex(193, 145.1875);
curveVertex(189, 138.1875);
curveVertex(186, 132.1875);
curveVertex(182, 127.1875);
endShape(CLOSE);
          beginShape();//lagrima izquierda
curveVertex(95, 128.1875);
curveVertex(91, 134.1875);
curveVertex(89, 141.1875);
curveVertex(89, 147.1875);
curveVertex(90, 153.1875);
curveVertex(94, 155.1875);
curveVertex(100, 157.1875);
curveVertex(106, 157.1875);
curveVertex(109, 153.1875);
curveVertex(110, 145.1875);
curveVertex(108, 139.1875);
curveVertex(102, 130.1875);
curveVertex(98, 127.1875);
endShape(CLOSE);
           beginShape();//nariz
vertex(144, 158.1875);
vertex(152, 155.1875);
vertex(158, 151.1875);
vertex(159, 147.1875);
vertex(155, 143.1875);
vertex(147, 143.1875);
vertex(138, 143.1875);
vertex(131, 146.1875);
vertex(131, 152.1875);
vertex(137, 155.1875);
endShape(CLOSE);
          beginShape();// boca
curveVertex(144, 159.1875);
curveVertex(143, 177.1875);
curveVertex(143, 184.1875);
curveVertex(146, 189.1875);
curveVertex(152, 193.1875);
curveVertex(158, 195.1875);
curveVertex(165, 195.1875);
curveVertex(172, 194.1875);
curveVertex(179, 194.1875);
curveVertex(184, 197.1875);
curveVertex(186, 200.1875);
curveVertex(189, 204.1875);
curveVertex(186, 199.1875);
curveVertex(181, 196.1875);
curveVertex(176, 194.1875);
curveVertex(169, 195.1875);
curveVertex(163, 194.1875);
curveVertex(155, 193.1875);
curveVertex(147, 189.1875);
curveVertex(143, 188.1875);
curveVertex(140, 187.1875);
curveVertex(136, 190.1875);
curveVertex(131, 193.1875);
curveVertex(126, 194.1875);
curveVertex(122, 195.1875);
curveVertex(116, 195.1875);
curveVertex(109, 194.1875);
curveVertex(105, 194.1875);
curveVertex(102, 197.1875);
curveVertex(97, 201.1875);
endShape();
          
          
          
          
          break;

        case 'angry':
          fill(200,0,0,150); // vermell
          stroke(0,0,0);//negre contorn
                beginShape();//oreja derecha
vertex(225, 71.1875);
vertex(232, 64.1875);
vertex(240, 60.1875);
vertex(248, 56.1875);
vertex(255, 52.1875);
vertex(262, 50.1875);
vertex(266, 51.1875);
vertex(268, 56.1875);
vertex(269, 61.1875);
vertex(270, 65.1875);
vertex(270, 70.1875);
vertex(270, 75.1875);
vertex(270, 80.1875);
vertex(269, 86.1875);
vertex(267, 91.1875);
vertex(265, 98.1875);
vertex(263, 105.1875);
vertex(256, 131.1875);
vertex(253, 123.1875);
vertex(251, 113.1875);
vertex(248, 106.1875);
vertex(243, 98.1875);
vertex(236, 87.1875);
vertex(230, 79.1875);
vertex(224, 71.1875);
endShape(CLOSE);

           beginShape();//oreja izquierda
vertex(73, 67.1875);
vertex(61, 77.1875);
vertex(49, 89.1875);
vertex(39, 101.1875);
vertex(32, 112.1875);
vertex(26, 128.1875);
vertex(27, 105.1875);
vertex(27, 95.1875);
vertex(27, 85.1875);
vertex(29, 75.1875);
vertex(32, 65.1875);
vertex(36, 49.1875);
vertex(47, 52.1875);
vertex(57, 57.1875);
vertex(64, 60.1875);
vertex(71, 66.1875);
endShape(CLOSE);

            beginShape();//cara
curveVertex(143, 254.1875);
curveVertex(155, 254.1875);
curveVertex(165, 251.1875);
curveVertex(175, 250.1875);
curveVertex(187, 247.1875);
curveVertex(204, 238.1875);
curveVertex(216, 230.1875);
curveVertex(224, 221.1875);
curveVertex(232, 214.1875);
curveVertex(240, 203.1875);
curveVertex(248, 189.1875);
curveVertex(253, 176.1875);
curveVertex(259, 157.1875);
curveVertex(260, 147.1875);
curveVertex(257, 135.1875);
curveVertex(252, 117.1875);
curveVertex(246, 105.1875);
curveVertex(240, 94.1875);
curveVertex(231, 83.1875);
curveVertex(223, 71.1875);
curveVertex(213, 60.1875);
curveVertex(205, 53.1875);
curveVertex(190, 52.1875);
curveVertex(154, 52.1875);
curveVertex(99, 53.1875);
curveVertex(87, 57.1875);
curveVertex(77, 66.1875);
curveVertex(58, 81.1875);
curveVertex(40, 99.1875);
curveVertex(33, 111.1875);
curveVertex(27, 127.1875);
curveVertex(27, 143.1875);
curveVertex(27, 165.1875);
curveVertex(30, 182.1875);
curveVertex(38, 201.1875);
curveVertex(49, 218.1875);
curveVertex(66, 233.1875);
curveVertex(80, 240.1875);
curveVertex(89, 244.1875);
curveVertex(96, 247.1875);
curveVertex(107, 250.1875);
curveVertex(117, 251.1875);
curveVertex(129, 253.1875);
curveVertex(142, 254.1875);
endShape(CLOSE);

          beginShape();//ceja derecha
vertex(162, 102.1875);
vertex(164, 104.1875);
vertex(169, 103.1875);
vertex(173, 101.1875);
vertex(178, 99.1875);
vertex(183, 96.1875);
vertex(187, 95.1875);
vertex(191, 94.1875);
vertex(195, 91.1875);
vertex(199, 90.1875);
vertex(197, 86.1875);
vertex(195, 83.1875);
vertex(191, 79.1875);
vertex(186, 80.1875);
vertex(181, 82.1875);
vertex(178, 85.1875);
vertex(174, 88.1875);
vertex(171, 90.1875);
vertex(167, 92.1875);
vertex(163, 94.1875);
vertex(159, 98.1875);
vertex(161, 99.1875);
endShape(CLOSE);

          beginShape();//ceja izquierda
vertex(115, 103.1875);
vertex(116, 99.1875);
vertex(113, 94.1875);
vertex(106, 91.1875);
vertex(100, 89.1875);
vertex(95, 87.1875);
vertex(90, 86.1875);
vertex(82, 82.1875);
vertex(76, 83.1875);
vertex(74, 86.1875);
vertex(74, 91.1875);
vertex(112, 103.1875);
endShape(CLOSE);

          beginShape();//ojo derecho
vertex(167, 118.1875);
vertex(171, 114.1875);
vertex(176, 112.1875);
vertex(181, 110.1875);
vertex(184, 108.1875);
vertex(188, 107.1875);
vertex(194, 105.1875);
vertex(197, 107.1875);
vertex(199, 111.1875);
vertex(198, 116.1875);
vertex(193, 122.1875);
vertex(188, 124.1875);
vertex(183, 124.1875);
vertex(176, 124.1875);
vertex(169, 122.1875);
endShape(CLOSE);

          beginShape();//ojo izquierdo
vertex(115, 115.1875);
vertex(112, 112.1875);
vertex(108, 111.1875);
vertex(102, 109.1875);
vertex(96, 106.1875);
vertex(88, 104.1875);
vertex(83, 104.1875);
vertex(81, 106.1875);
vertex(81, 111.1875);
vertex(85, 116.1875);
vertex(89, 118.1875);
vertex(93, 120.1875);
vertex(98, 121.1875);
vertex(108, 119.1875);
vertex(116, 115.1875);
endShape(CLOSE);

          beginShape();//zariz boca y dientes
vertex(144, 158.1875);
vertex(148, 157.1875);
vertex(151, 156.1875);
vertex(156, 153.1875);
vertex(159, 150.1875);
vertex(157, 145.1875);
vertex(149, 143.1875);
vertex(143, 143.1875);
vertex(137, 143.1875);
vertex(131, 145.1875);
vertex(129, 149.1875);
vertex(133, 153.1875);
vertex(137, 155.1875);
vertex(142, 158.1875);
vertex(143, 165.1875);
vertex(143, 169.1875);
vertex(144, 174.1875);
vertex(142, 181.1875);
vertex(146, 182.1875);
vertex(151, 182.1875);
vertex(155, 182.1875);
vertex(162, 183.1875);
vertex(166, 184.1875);
vertex(170, 185.1875);
vertex(173, 186.1875);
vertex(177, 188.1875);
vertex(181, 189.1875);
vertex(185, 192.1875);
vertex(188, 194.1875);
vertex(187, 193.1875);
vertex(184, 191.1875);
vertex(181, 190.1875);
vertex(178, 188.1875);
vertex(173, 186.1875);
vertex(168, 184.1875);
vertex(159, 182.1875);
vertex(153, 182.1875);
vertex(140, 181.1875);
vertex(136, 181.1875);
vertex(133, 181.1875);
vertex(128, 183.1875);
vertex(122, 184.1875);
vertex(114, 185.1875);
vertex(110, 187.1875);
vertex(103, 187.1875);
vertex(100, 189.1875);
vertex(105, 188.1875);
vertex(109, 189.1875);
vertex(112, 193.1875);
vertex(114, 197.1875);
vertex(117, 202.1875);
vertex(124, 186.1875);
vertex(132, 183.1875);
vertex(143, 181.1875);
vertex(152, 181.1875);
vertex(161, 182.1875);
vertex(167, 184.1875);
vertex(167, 191.1875);
vertex(167, 197.1875);
vertex(167, 201.1875);
vertex(179, 189.1875);
endShape();
          break;

        case 'fearful':
          fill(100,100,100,150); // gris
          stroke(0,0,0);// negre del contorn
          beginShape();
          beginShape();//cara
curveVertex(143, 254.1875);
curveVertex(155, 254.1875);
curveVertex(165, 251.1875);
curveVertex(175, 250.1875);
curveVertex(187, 247.1875);
curveVertex(204, 238.1875);
curveVertex(216, 230.1875);
curveVertex(224, 221.1875);
curveVertex(232, 214.1875);
curveVertex(240, 203.1875);
curveVertex(248, 189.1875);
curveVertex(253, 176.1875);
curveVertex(259, 157.1875);
curveVertex(260, 147.1875);
curveVertex(257, 135.1875);
curveVertex(252, 117.1875);
curveVertex(246, 105.1875);
curveVertex(240, 94.1875);
curveVertex(231, 83.1875);
curveVertex(223, 71.1875);
curveVertex(213, 60.1875);
curveVertex(205, 53.1875);
curveVertex(190, 52.1875);
curveVertex(154, 52.1875);
curveVertex(99, 53.1875);
curveVertex(87, 57.1875);
curveVertex(77, 66.1875);
curveVertex(58, 81.1875);
curveVertex(40, 99.1875);
curveVertex(33, 111.1875);
curveVertex(27, 127.1875);
curveVertex(27, 143.1875);
curveVertex(27, 165.1875);
curveVertex(30, 182.1875);
curveVertex(38, 201.1875);
curveVertex(49, 218.1875);
curveVertex(66, 233.1875);
curveVertex(80, 240.1875);
curveVertex(89, 244.1875);
curveVertex(96, 247.1875);
curveVertex(107, 250.1875);
curveVertex(117, 251.1875);
curveVertex(129, 253.1875);
curveVertex(142, 254.1875);
endShape(CLOSE);

          beginShape();//ceja derecha
vertex(170, 90.1875);
vertex(173, 90.1875);
vertex(177, 91.1875);
vertex(180, 92.1875);
vertex(184, 93.1875);
vertex(189, 95.1875);
vertex(192, 96.1875);
vertex(197, 97.1875);
vertex(200, 99.1875);
vertex(205, 102.1875);
vertex(209, 104.1875);
vertex(210, 98.1875);
vertex(207, 91.1875);
vertex(202, 88.1875);
vertex(197, 85.1875);
vertex(190, 83.1875);
vertex(183, 81.1875);
vertex(177, 79.1875);
vertex(171, 78.1875);
vertex(166, 78.1875);
vertex(163, 87.1875);
vertex(167, 89.1875);
endShape(CLOSE);

          beginShape();//ceja izquierda
vertex(119, 92.1875);
vertex(115, 92.1875);
vertex(110, 93.1875);
vertex(102, 93.1875);
vertex(102, 93.1875);
vertex(95, 95.1875);
vertex(88, 97.1875);
vertex(83, 98.1875);
vertex(76, 100.1875);
vertex(73, 94.1875);
vertex(78, 90.1875);
vertex(83, 87.1875);
vertex(89, 86.1875);
vertex(93, 85.1875);
vertex(100, 83.1875);
vertex(105, 83.1875);
vertex(110, 83.1875);
vertex(116, 81.1875);
vertex(119, 88.1875);
endShape(CLOSE);

          beginShape();//ojo derecho
vertex(180, 103.1875);
vertex(176, 104.1875);
vertex(174, 107.1875);
vertex(172, 110.1875);
vertex(171, 114.1875);
vertex(171, 118.1875);
vertex(172, 122.1875);
vertex(173, 125.1875);
vertex(177, 128.1875);
vertex(179, 129.1875);
vertex(182, 130.1875);
vertex(185, 130.1875);
vertex(188, 130.1875);
vertex(190, 128.1875);
vertex(193, 124.1875);
vertex(193, 124.1875);
vertex(194, 120.1875);
vertex(194, 116.1875);
vertex(194, 111.1875);
vertex(191, 108.1875);
vertex(188, 104.1875);
vertex(181, 102.1875);
endShape(CLOSE);

          beginShape();//ojo izquierdo
vertex(88, 113.1875);
vertex(87, 116.1875);
vertex(87, 119.1875);
vertex(88, 124.1875);
vertex(91, 126.1875);
vertex(94, 127.1875);
vertex(100, 128.1875);
vertex(104, 127.1875);
vertex(107, 123.1875);
vertex(108, 119.1875);
vertex(108, 114.1875);
vertex(107, 108.1875);
vertex(103, 105.1875);
vertex(99, 104.1875);
vertex(94, 104.1875);
vertex(91, 106.1875);
vertex(90, 110.1875);
endShape(CLOSE);

          beginShape();//nariz
vertex(144, 158.1875);
vertex(147, 157.1875);
vertex(151, 156.1875);
vertex(155, 153.1875);
vertex(158, 150.1875);
vertex(156, 146.1875);
vertex(151, 144.1875);
vertex(146, 143.1875);
vertex(141, 143.1875);
vertex(136, 144.1875);
vertex(132, 146.1875);
vertex(131, 151.1875);
vertex(133, 153.1875);
vertex(141, 157.1875);
endShape(CLOSE);

          beginShape();//boca
vertex(109, 198.1875);
vertex(113, 195.1875);
vertex(117, 193.1875);
vertex(121, 191.1875);
vertex(126, 189.1875);
vertex(131, 188.1875);
vertex(137, 187.1875);
vertex(141, 186.1875);
vertex(145, 186.1875);
vertex(151, 186.1875);
vertex(154, 187.1875);
vertex(159, 189.1875);
vertex(161, 189.1875);
vertex(165, 191.1875);
vertex(168, 192.1875);
vertex(174, 196.1875);
vertex(179, 200.1875);
vertex(181, 204.1875);
vertex(181, 208.1875);
vertex(181, 212.1875);
vertex(178, 216.1875);
vertex(175, 219.1875);
vertex(169, 221.1875);
vertex(165, 222.1875);
vertex(160, 221.1875);
vertex(155, 219.1875);
vertex(152, 217.1875);
vertex(150, 217.1875);
vertex(146, 217.1875);
vertex(141, 217.1875);
vertex(136, 217.1875);
vertex(132, 217.1875);
vertex(131, 218.1875);
vertex(126, 223.1875);
vertex(120, 223.1875);
vertex(114, 221.1875);
vertex(106, 218.1875);
vertex(104, 212.1875);
vertex(104, 207.1875);
vertex(107, 199.1875);
endShape(CLOSE);

      beginShape();//oreja derecha
vertex(222, 71.1875);
vertex(265, 49.1875);
vertex(255, 131.1875);
vertex(252, 119.1875);
vertex(249, 110.1875);
vertex(246, 105.1875);
vertex(243, 98.1875);
vertex(238, 91.1875);
vertex(233, 86.1875);
vertex(221, 72.1875);
endShape(CLOSE);

          beginShape();//oreja izquierda
vertex(74, 69.1875);
vertex(36, 50.1875);
vertex(27, 127.1875);
vertex(32, 111.1875);
vertex(37, 104.1875);
vertex(42, 98.1875);
vertex(48, 90.1875);
vertex(53, 83.1875);
vertex(72, 69.1875);
endShape(CLOSE);
          
          endShape();
          break;

        case 'surprised':
          fill(0,150,255,150); // blau clar
          stroke(0,0,0);//negre del contorn
            beginShape();//oreja derecha
vertex(225, 71.1875);
vertex(232, 64.1875);
vertex(240, 60.1875);
vertex(248, 56.1875);
vertex(255, 52.1875);
vertex(262, 50.1875);
vertex(266, 51.1875);
vertex(268, 56.1875);
vertex(269, 61.1875);
vertex(270, 65.1875);
vertex(270, 70.1875);
vertex(270, 75.1875);
vertex(270, 80.1875);
vertex(269, 86.1875);
vertex(267, 91.1875);
vertex(265, 98.1875);
vertex(263, 105.1875);
vertex(256, 131.1875);
vertex(253, 123.1875);
vertex(251, 113.1875);
vertex(248, 106.1875);
vertex(243, 98.1875);
vertex(236, 87.1875);
vertex(230, 79.1875);
vertex(224, 71.1875);
endShape(CLOSE);

           beginShape();//oreja izquierda
vertex(73, 67.1875);
vertex(61, 77.1875);
vertex(49, 89.1875);
vertex(39, 101.1875);
vertex(32, 112.1875);
vertex(26, 128.1875);
vertex(27, 105.1875);
vertex(27, 95.1875);
vertex(27, 85.1875);
vertex(29, 75.1875);
vertex(32, 65.1875);
vertex(36, 49.1875);
vertex(47, 52.1875);
vertex(57, 57.1875);
vertex(64, 60.1875);
vertex(71, 66.1875);
endShape(CLOSE);

            beginShape();//cara
curveVertex(143, 254.1875);
curveVertex(155, 254.1875);
curveVertex(165, 251.1875);
curveVertex(175, 250.1875);
curveVertex(187, 247.1875);
curveVertex(204, 238.1875);
curveVertex(216, 230.1875);
curveVertex(224, 221.1875);
curveVertex(232, 214.1875);
curveVertex(240, 203.1875);
curveVertex(248, 189.1875);
curveVertex(253, 176.1875);
curveVertex(259, 157.1875);
curveVertex(260, 147.1875);
curveVertex(257, 135.1875);
curveVertex(252, 117.1875);
curveVertex(246, 105.1875);
curveVertex(240, 94.1875);
curveVertex(231, 83.1875);
curveVertex(223, 71.1875);
curveVertex(213, 60.1875);
curveVertex(205, 53.1875);
curveVertex(190, 52.1875);
curveVertex(154, 52.1875);
curveVertex(99, 53.1875);
curveVertex(87, 57.1875);
curveVertex(77, 66.1875);
curveVertex(58, 81.1875);
curveVertex(40, 99.1875);
curveVertex(33, 111.1875);
curveVertex(27, 127.1875);
curveVertex(27, 143.1875);
curveVertex(27, 165.1875);
curveVertex(30, 182.1875);
curveVertex(38, 201.1875);
curveVertex(49, 218.1875);
curveVertex(66, 233.1875);
curveVertex(80, 240.1875);
curveVertex(89, 244.1875);
curveVertex(96, 247.1875);
curveVertex(107, 250.1875);
curveVertex(117, 251.1875);
curveVertex(129, 253.1875);
curveVertex(142, 254.1875);
endShape(CLOSE);

          beginShape();//ojo derecho
vertex(167, 117.1875);
vertex(167, 121.1875);
vertex(169, 126.1875);
vertex(173, 129.1875);
vertex(177, 131.1875);
vertex(181, 132.1875);
vertex(186, 132.1875);
vertex(190, 131.1875);
vertex(194, 129.1875);
vertex(197, 126.1875);
vertex(198, 122.1875);
vertex(199, 117.1875);
vertex(197, 113.1875);
vertex(194, 109.1875);
vertex(190, 106.1875);
vertex(186, 104.1875);
vertex(181, 104.1875);
vertex(176, 104.1875);
vertex(171, 105.1875);
vertex(168, 109.1875);
endShape(CLOSE);

          beginShape();//ojo izquierdo
vertex(79, 116.1875);
vertex(80, 112.1875);
vertex(81, 108.1875);
vertex(84, 105.1875);
vertex(88, 102.1875);
vertex(91, 102.1875);
vertex(95, 101.1875);
vertex(99, 101.1875);
vertex(103, 102.1875);
vertex(106, 104.1875);
vertex(108, 107.1875);
vertex(110, 109.1875);
vertex(111, 112.1875);
vertex(111, 116.1875);
vertex(110, 120.1875);
vertex(108, 124.1875);
vertex(104, 127.1875);
vertex(100, 129.1875);
vertex(95, 129.1875);
vertex(90, 128.1875);
vertex(85, 125.1875);
endShape(CLOSE);

          beginShape();//narix y mofletes
vertex(143, 158.1875);
vertex(138, 156.1875);
vertex(134, 154.1875);
vertex(130, 150.1875);
vertex(132, 145.1875);
vertex(138, 143.1875);
vertex(153, 143.1875);
vertex(157, 145.1875);
vertex(160, 149.1875);
vertex(157, 153.1875);
vertex(153, 155.1875);
vertex(147, 158.1875);
vertex(144, 162.1875);
vertex(143, 167.1875);
vertex(144, 171.1875);
vertex(142, 175.1875);
vertex(142, 179.1875);
vertex(144, 184.1875);
vertex(146, 189.1875);
vertex(149, 192.1875);
vertex(153, 193.1875);
vertex(158, 195.1875);
vertex(164, 196.1875);
vertex(169, 195.1875);
vertex(168, 196.1875);
vertex(160, 194.1875);
vertex(155, 193.1875);
vertex(150, 192.1875);
vertex(146, 189.1875);
vertex(142, 186.1875);
vertex(138, 190.1875);
vertex(132, 192.1875);
vertex(125, 195.1875);
vertex(119, 196.1875);
vertex(114, 196.1875);
endShape();

          beginShape();//boca
vertex(140, 202.1875);
vertex(145, 200.1875);
vertex(149, 201.1875);
vertex(155, 203.1875);
vertex(157, 205.1875);
vertex(161, 210.1875);
vertex(163, 216.1875);
vertex(163, 222.1875);
vertex(161, 231.1875);
vertex(154, 233.1875);
vertex(140, 235.1875);
vertex(130, 235.1875);
vertex(121, 231.1875);
vertex(117, 227.1875);
vertex(116, 222.1875);
vertex(116, 215.1875);
vertex(117, 211.1875);
vertex(121, 205.1875);
vertex(125, 204.1875);
vertex(131, 203.1875);
vertex(137, 202.1875);
endShape(CLOSE);
          
        break;
        case 'disgusted':
          fill(0,150,0,150); // verd
          stroke(0,0,0);//negre contorn
          beginShape();//cara
curveVertex(143, 254.1875);
curveVertex(155, 254.1875);
curveVertex(165, 251.1875);
curveVertex(175, 250.1875);
curveVertex(187, 247.1875);
curveVertex(204, 238.1875);
curveVertex(216, 230.1875);
curveVertex(224, 221.1875);
curveVertex(232, 214.1875);
curveVertex(240, 203.1875);
curveVertex(248, 189.1875);
curveVertex(253, 176.1875);
curveVertex(259, 157.1875);
curveVertex(260, 147.1875);
curveVertex(257, 135.1875);
curveVertex(252, 117.1875);
curveVertex(246, 105.1875);
curveVertex(240, 94.1875);
curveVertex(231, 83.1875);
curveVertex(223, 71.1875);
curveVertex(213, 60.1875);
curveVertex(205, 53.1875);
curveVertex(190, 52.1875);
curveVertex(154, 52.1875);
curveVertex(99, 53.1875);
curveVertex(87, 57.1875);
curveVertex(77, 66.1875);
curveVertex(58, 81.1875);
curveVertex(40, 99.1875);
curveVertex(33, 111.1875);
curveVertex(27, 127.1875);
curveVertex(27, 143.1875);
curveVertex(27, 165.1875);
curveVertex(30, 182.1875);
curveVertex(38, 201.1875);
curveVertex(49, 218.1875);
curveVertex(66, 233.1875);
curveVertex(80, 240.1875);
curveVertex(89, 244.1875);
curveVertex(96, 247.1875);
curveVertex(107, 250.1875);
curveVertex(117, 251.1875);
curveVertex(129, 253.1875);
curveVertex(142, 254.1875);
endShape(CLOSE);
          
          beginShape();//oreja derecha
vertex(224, 71.1875);
vertex(227, 67.1875);
vertex(231, 64.1875);
vertex(236, 61.1875);
vertex(241, 59.1875);
vertex(245, 57.1875);
vertex(251, 54.1875);
vertex(256, 55.1875);
vertex(260, 57.1875);
vertex(264, 59.1875);
vertex(267, 62.1875);
vertex(270, 65.1875);
vertex(273, 70.1875);
vertex(273, 76.1875);
vertex(273, 80.1875);
vertex(273, 85.1875);
vertex(273, 93.1875);
vertex(273, 98.1875);
vertex(262, 92.1875);
vertex(257, 88.1875);
vertex(251, 84.1875);
vertex(249, 83.1875);
vertex(260, 91.1875);
vertex(259, 95.1875);
vertex(258, 102.1875);
vertex(258, 110.1875);
vertex(254, 125.1875);
vertex(252, 119.1875);
vertex(250, 115.1875);
vertex(248, 108.1875);
vertex(245, 104.1875);
vertex(242, 98.1875);
vertex(241, 95.1875);
vertex(238, 91.1875);
vertex(234, 86.1875);
vertex(232, 84.1875);
vertex(229, 80.1875);
vertex(222, 71.1875);
endShape(CLOSE);

          beginShape();//oreja izquierda
vertex(74, 68.1875);
vertex(69, 64.1875);
vertex(65, 62.1875);
vertex(58, 59.1875);
vertex(52, 56.1875);
vertex(47, 55.1875);
vertex(43, 55.1875);
vertex(37, 56.1875);
vertex(31, 59.1875);
vertex(30, 62.1875);
vertex(28, 66.1875);
vertex(25, 72.1875);
vertex(24, 75.1875);
vertex(21, 80.1875);
vertex(18, 85.1875);
vertex(13, 92.1875);
vertex(13, 95.1875);
vertex(14, 99.1875);
vertex(17, 99.1875);
vertex(20, 97.1875);
vertex(25, 95.1875);
vertex(30, 92.1875);
vertex(35, 88.1875);
vertex(26, 94.1875);
vertex(26, 98.1875);
vertex(26, 101.1875);
vertex(26, 105.1875);
vertex(27, 109.1875);
vertex(27, 113.1875);
vertex(29, 117.1875);
vertex(32, 113.1875);
vertex(35, 108.1875);
vertex(37, 104.1875);
vertex(41, 97.1875);
vertex(45, 92.1875);
vertex(50, 88.1875);
vertex(56, 83.1875);
vertex(61, 77.1875);
vertex(66, 73.1875);
vertex(74, 68.1875);
endShape(CLOSE);

          beginShape();//ojo derecho
vertex(167, 110.1875);
vertex(167, 114.1875);
vertex(170, 117.1875);
vertex(172, 118.1875);
vertex(177, 119.1875);
vertex(180, 120.1875);
vertex(185, 120.1875);
vertex(190, 118.1875);
vertex(194, 115.1875);
vertex(195, 110.1875);
endShape();

          beginShape();//ojo izquierdo
vertex(81, 113.1875);
vertex(83, 116.1875);
vertex(86, 119.1875);
vertex(89, 121.1875);
vertex(94, 123.1875);
vertex(98, 123.1875);
vertex(101, 123.1875);
vertex(104, 121.1875);
vertex(106, 119.1875);
vertex(109, 115.1875);
endShape();

          beginShape();//nariz y boca
vertex(143, 157.1875);
vertex(147, 157.1875);
vertex(151, 156.1875);
vertex(156, 154.1875);
vertex(158, 152.1875);
vertex(160, 145.1875);
vertex(155, 143.1875);
vertex(148, 143.1875);
vertex(142, 143.1875);
vertex(137, 144.1875);
vertex(132, 145.1875);
vertex(131, 148.1875);
vertex(133, 151.1875);
vertex(134, 152.1875);
vertex(138, 155.1875);
vertex(142, 158.1875);
vertex(143, 162.1875);
vertex(143, 166.1875);
vertex(144, 172.1875);
vertex(144, 177.1875);
vertex(143, 181.1875);
vertex(140, 182.1875);
vertex(136, 183.1875);
vertex(130, 183.1875);
vertex(126, 184.1875);
vertex(121, 185.1875);
vertex(115, 187.1875);
vertex(108, 190.1875);
vertex(110, 188.1875);
vertex(114, 187.1875);
vertex(119, 185.1875);
vertex(126, 184.1875);
vertex(132, 183.1875);
vertex(137, 182.1875);
vertex(140, 182.1875);
vertex(145, 182.1875);
vertex(148, 183.1875);
vertex(151, 184.1875);
vertex(156, 186.1875);
vertex(156, 186.1875);
vertex(160, 187.1875);
vertex(166, 189.1875);
vertex(169, 190.1875);
vertex(171, 192.1875);
endShape();
        

      
          break;

        default:
          fill(171-intensity*79, 134, 94-intensity*90)//marron
          stroke(0,0,0);//negre contorn
          beginShape();//oreja derecha
vertex(225, 71.1875);
vertex(232, 64.1875);
vertex(240, 60.1875);
vertex(248, 56.1875);
vertex(255, 52.1875);
vertex(262, 50.1875);
vertex(266, 51.1875);
vertex(268, 56.1875);
vertex(269, 61.1875);
vertex(270, 65.1875);
vertex(270, 70.1875);
vertex(270, 75.1875);
vertex(270, 80.1875);
vertex(269, 86.1875);
vertex(267, 91.1875);
vertex(265, 98.1875);
vertex(263, 105.1875);
vertex(256, 131.1875);
vertex(253, 123.1875);
vertex(251, 113.1875);
vertex(248, 106.1875);
vertex(243, 98.1875);
vertex(236, 87.1875);
vertex(230, 79.1875);
vertex(224, 71.1875);
endShape(CLOSE);
          beginShape();//oreja izquierda
vertex(73, 67.1875);
vertex(61, 77.1875);
vertex(49, 89.1875);
vertex(39, 101.1875);
vertex(32, 112.1875);
vertex(26, 128.1875);
vertex(27, 105.1875);
vertex(27, 95.1875);
vertex(27, 85.1875);
vertex(29, 75.1875);
vertex(32, 65.1875);
vertex(36, 49.1875);
vertex(47, 52.1875);
vertex(57, 57.1875);
vertex(64, 60.1875);
vertex(71, 66.1875);
endShape(CLOSE);

           beginShape();//cara
curveVertex(143, 254.1875);
curveVertex(155, 254.1875);
curveVertex(165, 251.1875);
curveVertex(175, 250.1875);
curveVertex(187, 247.1875);
curveVertex(204, 238.1875);
curveVertex(216, 230.1875);
curveVertex(224, 221.1875);
curveVertex(232, 214.1875);
curveVertex(240, 203.1875);
curveVertex(248, 189.1875);
curveVertex(253, 176.1875);
curveVertex(259, 157.1875);
curveVertex(260, 147.1875);
curveVertex(257, 135.1875);
curveVertex(252, 117.1875);
curveVertex(246, 105.1875);
curveVertex(240, 94.1875);
curveVertex(231, 83.1875);
curveVertex(223, 71.1875);
curveVertex(213, 60.1875);
curveVertex(205, 53.1875);
curveVertex(190, 52.1875);
curveVertex(154, 52.1875);
curveVertex(99, 53.1875);
curveVertex(87, 57.1875);
curveVertex(77, 66.1875);
curveVertex(58, 81.1875);
curveVertex(40, 99.1875);
curveVertex(33, 111.1875);
curveVertex(27, 127.1875);
curveVertex(27, 143.1875);
curveVertex(27, 165.1875);
curveVertex(30, 182.1875);
curveVertex(38, 201.1875);
curveVertex(49, 218.1875);
curveVertex(66, 233.1875);
curveVertex(80, 240.1875);
curveVertex(89, 244.1875);
curveVertex(96, 247.1875);
curveVertex(107, 250.1875);
curveVertex(117, 251.1875);
curveVertex(129, 253.1875);
curveVertex(142, 254.1875);
endShape(CLOSE);

          beginShape();//ojo derecho
vertex(167, 118.1875);
vertex(170, 121.1875);
vertex(174, 123.1875);
vertex(178, 124.1875);
vertex(184, 125.1875);
vertex(189, 124.1875);
vertex(194, 123.1875);
vertex(199, 119.1875);
vertex(197, 115.1875);
vertex(193, 112.1875);
vertex(187, 110.1875);
vertex(181, 111.1875);
vertex(175, 112.1875);
vertex(167, 116.1875);
endShape(CLOSE);

          beginShape();//ojo izquierdo
vertex(117, 116.1875);
vertex(111, 113.1875);
vertex(105, 112.1875);
vertex(98, 111.1875);
vertex(89, 113.1875);
vertex(80, 116.1875);
vertex(78, 117.1875);
vertex(81, 120.1875);
vertex(86, 124.1875);
vertex(91, 126.1875);
vertex(96, 127.1875);
vertex(102, 127.1875);
vertex(108, 125.1875);
vertex(113, 121.1875);
vertex(116, 118.1875);
endShape(CLOSE);

          beginShape();//nariz y boca
vertex(144, 158.1875);
vertex(137, 156.1875);
vertex(131, 153.1875);
vertex(129, 148.1875);
vertex(133, 144.1875);
vertex(138, 143.1875);
vertex(143, 142.1875);
vertex(148, 142.1875);
vertex(152, 143.1875);
vertex(157, 146.1875);
vertex(159, 151.1875);
vertex(156, 153.1875);
vertex(152, 155.1875);
vertex(147, 158.1875);
vertex(143, 162.1875);
vertex(142, 168.1875);
vertex(142, 172.1875);
vertex(142, 177.1875);
vertex(142, 182.1875);
vertex(144, 187.1875);
vertex(146, 190.1875);
vertex(150, 192.1875);
vertex(153, 192.1875);
vertex(156, 193.1875);
vertex(159, 194.1875);
vertex(163, 194.1875);
vertex(167, 194.1875);
vertex(170, 194.1875);
vertex(175, 194.1875);
vertex(180, 195.1875);
vertex(175, 194.1875);
vertex(168, 193.1875);
vertex(159, 193.1875);
vertex(152, 192.1875);
vertex(144, 188.1875);
vertex(140, 187.1875);
vertex(137, 190.1875);
vertex(132, 192.1875);
vertex(128, 194.1875);
vertex(122, 195.1875);
vertex(117, 195.1875);
vertex(113, 195.1875);
vertex(109, 194.1875);
vertex(105, 192.1875);
endShape();

          
      }
      }

    // Funci√≥ per dibuixar el Heads-Up Display (HUD) amb informaci√≥ sobre l'expressi√≥ detectada.
    function drawHUD() {
      // Extrau la informaci√≥ de l'expressi√≥ actual: la clau dominant i la seva intensitat.
      const { dominant, intensity } = currentExpression;
      
      // Definim un objecte que mapeja cada expressi√≥ amb un emoticona i una descripci√≥ en catal√†.
      const traduccions = {
        happy: "üòÉ Feli√ß",
        sad: "üò¢ Trist",
        angry: "üò° Enfadat",
        surprised: "üò≤ Sorpr√®s",
        disgusted: "ü§¢ Fastiguejat",
        neutral: "üòê Neutral",
        fearful: "üò® Espantat" // Tot i que la por no es gestiona amb un dibuix espec√≠fic, es mostra aqu√≠.
      };

      // Selecciona l'emoticona i text a partir de l'expressi√≥ dominant, per defecte utilitza "Neutral".
      const emoticon = traduccions[dominant] || "üòê Neutral";      
      noStroke(); // No dibuixem contorns al text.
      fill(50, 150, 255); // Defineix el color del text.
      // Ajusta la mida del text de forma responsive segons l'amplada de la finestra.
      textSize(map(width, 300, 1200, 16, 24));
      textAlign(CENTER, TOP); // Centra horizontalment el text i el posiciona a la part superior.
      // Dibuixa el text amb l'emoticona i la intensitat (convertida a percentatge) a la part superior central.
      text(`${emoticon} (${floor(intensity * 100)}%)`, width / 2, 20);
    }

    // Funci√≥ per dibuixar una petita previsualitzaci√≥ del v√≠deo a la cantonada inferior dreta.
    function drawVideoPreview() {
      // Calcula el tamany de la previsualitzaci√≥ basant-se en la mida m√≠nima de la finestra.
      const previewSize = min(width, height) * 0.15;
      // Dibuixa la imatge de la c√†mera en la posici√≥ desitjada (10 p√≠xels d'espai a la dreta i a baix).
      image(video,
        width - previewSize - 10,  // Posici√≥ horitzontal (a la dreta).
        height - previewSize - 10, // Posici√≥ vertical (a baix).
        previewSize,             // Amplada de la previsualitzaci√≥.
        previewSize              // Al√ßada de la previsualitzaci√≥.
      );
    } 
    

    // Sol¬∑licitem acc√©s a la c√†mera del dispositiu. Si hi ha un error (per exemple, l'usuari el rebutja),
    // es mostrar√† un missatge d'error a la pantalla de c√†rrega.
    navigator.mediaDevices.getUserMedia({ video: true })
      .catch(err => {
        // En cas d'error, actualitza el contingut de la pantalla de c√†rrega amb una notificaci√≥ d'error.
        document.getElementById('loading-screen').innerHTML = `
          <p style="color: red; text-align: center">
            Error de c√†mera!<br>
            Permet l'acc√©s a la c√†mera i actualitza.
          </p>
        `;
      });
  </script>
</body>
</html>
